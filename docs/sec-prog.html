<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Chapter 9 Additional programming concepts | Introduction to bioinformatics" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Course material for the Introduction to bioinformatics (WSBIM1207) course at UCLouvain." />


<meta name="author" content="Laurent Gatto" />

<meta name="date" content="2019-02-22" />


<meta name="description" content="Course material for the Introduction to bioinformatics (WSBIM1207) course at UCLouvain.">

<title>Chapter 9 Additional programming concepts | Introduction to bioinformatics</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/jquery-1.12.4/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Introduction to bioinformatics<p><p class="author">Laurent Gatto</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Preamble</a>
<a href="sec-dataorg.html"><span class="toc-section-number">1</span> Data organisation with Spreadsheets</a>
<a href="sec-startr.html"><span class="toc-section-number">2</span> Starting with R</a>
<a href="sec-startdata.html"><span class="toc-section-number">3</span> Starting with data</a>
<a href="sec-dplyr.html"><span class="toc-section-number">4</span> Manipulating and analyzing data with dplyr</a>
<a href="sec-vis.html"><span class="toc-section-number">5</span> Data visualization</a>
<a href="sec-join.html"><span class="toc-section-number">6</span> Joining tables</a>
<a href="sec-rr.html"><span class="toc-section-number">7</span> Reproducible research</a>
<a href="sec-bioinfo.html"><span class="toc-section-number">8</span> Bioinformatics</a>
<a id="active-page" href="sec-prog.html"><span class="toc-section-number">9</span> Additional programming concepts</a><ul class="toc-sections">
<li class="toc"><a href="#writing-clean-code"> Writing clean code</a></li>
<li class="toc"><a href="#writing-new-functions"> Writing new functions</a></li>
<li class="toc"><a href="#iteration"> Iteration</a></li>
<li class="toc"><a href="#conditionals"> Conditionals</a></li>
<li class="toc"><a href="#example-iterating-over-files"> Example: iterating over files</a></li>
</ul>
<a href="sec-ccl.html"><span class="toc-section-number">10</span> Conclusions</a>
<a href="session-information.html">Session information</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="sec:prog" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Additional programming concepts</h1>
<p><strong>Learning Objectives</strong></p>
<p>Learn programming concepts, including</p>
<ul>
<li>how to handle conditions</li>
<li>iterate of data structures</li>
<li>good coding practice</li>
<li>code re-use through functions</li>
</ul>
<p>When the size and the complexity of the data increases, or the data
science question of interest becomes more complex, the data analysis
techniques as we have seen them so far need to be complemented with
programming techniques. From a data science point of view, there is no
clear delimitation between data analysis and (data) programming, both
morphing into each other<label for="tufte-sn-16" class="margin-toggle sidenote-number">16</label><input type="checkbox" id="tufte-sn-16" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">16</span> A fundamental difference however is how data analysis and
programming are taught. When it comes to researchers, and
biomedical researchers in particular, teaching programming to
analyse data isn’t successful. Teaching data analysis to
eventually programme with data, however, has proven a successful
strategy.</span>.</p>
<p>This chapter will introduce some additional programming skills and
demonstrate how to use them in the context of high troughput omics
data.</p>
<div id="writing-clean-code" class="section level2">
<h2><span class="header-section-number">9.1</span> Writing clean code</h2>
<p>Writing clean code means writing easily readable code, hence easily
understable code and, eventually code with less bugs. One easy way to
achieve this is through consistency, i.e. stick to a <strong>style
guide</strong>. This issue is that there are several style guides available,
often with conflicting suggestions. Two widely used ones are the
<a href="http://bioconductor.org/developers/how-to/coding-style/">Bioconductor style
guide</a> and
<a href="http://r-pkgs.had.co.nz/style.html">Hadley Wickhams’s R Style
Guide</a>. The advice from for naming
variables seen in the first and second chapters are also relevant.</p>
<p>Here are a couple of suggestions:</p>
<ul>
<li>Use <code>&lt;-</code> to assign variables. Use <code>=</code> is also valid, but make sure
that you stick with one.</li>
<li>Use either camel case (<code>camelCaseNaming</code>) of snake case
(<code>snake_case_naming</code>), and avoid using dots (don’t use
<code>dot.variable.names</code>). These conventions apply to functions,
variables and files (for the latter, a <code>-</code> instead of <code>_</code> is also
acceptable).</li>
<li>Always spell out <code>TRUE</code> and <code>FALSE</code>, and resist the temptation to
use <code>T</code> and <code>F</code> instead.</li>
<li>Use 4 spaces for indenting. No tabs.</li>
<li>No lines longer than 80 characters.</li>
<li>Use spaces around binary operators.</li>
<li>No spaces between a function name and the opening parenthesis.</li>
</ul>
<p>Another good advise is to avoid re-writing the same code many
times. We will see below two strategies to do that, namely iteration
and writing new functions. This firstly reduces the amount of code
typed and hence the number of bugs, but more importantly enables
consistency. If something in your code changes, there’s only one
change and it applies everywhere, rather than doing that same change
repeatedly (at the first of adding bugs and to miss some updates).</p>
<p>When writing code, <strong>keep it simple and short</strong><label for="tufte-sn-17" class="margin-toggle sidenote-number">17</label><input type="checkbox" id="tufte-sn-17" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">17</span> The official motto is
<a href="https://en.wikipedia.org/wiki/KISS_principle">KISS</a>, <em>keep your
functions simple, stupid</em>, widely used in programming.</span>. Ideally, the
code should be evident. But when the questions tackled are not
trivial, is becomes essential to add <strong>comments</strong> to clarify aspects
of the script/programme. Make sure to use them to describe why
something is done, rather than explaining how things are done (which
is tyically best done by the code itself).</p>
<p>A general guideline to avoid bugs is to apply <strong>defensive
programming</strong>:</p>
<ul>
<li>making the code work in a predicable manner</li>
<li>writing code that fails in a well-defined manner</li>
<li>if something weird happens, either properly deal with it, of fail
quickly and loudly</li>
</ul>
<p>Here are some examples of how to do this:</p>
<ul>
<li><p>use functions like <code>is.numeric(x)</code>, <code>is.character(x)</code>,
<code>is.data.frame(x)</code>, … for make sure that the variable you are
going to use is of the expected type.</p></li>
<li><p>Make sure the length or dimensions of what you are going to use are
what you expect:</p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>
<span class="kw">nrow</span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>
<span class="kw">ncol</span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></code></pre>
<ul>
<li>Failing fast and well! Wrap such test in <code>stopifnot()</code>, so that if
they fail, you get immediately an error, rather than risking that
you code fails later with obscure error messages or, worse, the code
runs to completion but returns meaningless results.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stopifnot</span>(<span class="kw">length</span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
<span class="kw">stopifnot</span>(<span class="kw">ncol</span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="kw">nrow</span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</code></pre>
</div>
<div id="writing-new-functions" class="section level2">
<h2><span class="header-section-number">9.2</span> Writing new functions</h2>
<p>A function is composed of a name, inputs (inside the parenthesis), a
body (between curly brackets) and an ouput (last statement or variably
inside the <code>return</code> statement).</p>
<pre class="sourceCode r"><code class="sourceCode r">my_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
    <span class="kw">message</span>(<span class="st">&quot;First input: &quot;</span>, x)
    <span class="kw">message</span>(<span class="st">&quot;Second input: &quot;</span>, y)
    z &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(y)
    <span class="kw">return</span>(z)
}
<span class="kw">my_fun</span>(<span class="dv">2</span>, <span class="dv">-5</span>)</code></pre>
<pre><code>## First input: 2</code></pre>
<pre><code>## Second input: -5</code></pre>
<pre><code>## [1] 10</code></pre>
</div>
<div id="iteration" class="section level2">
<h2><span class="header-section-number">9.3</span> Iteration</h2>
<p>Iteration describes the situtation when a specific operation has to be
repeated many times on different inputs of the same type. For example,
if we have a vector of numeric <code>x</code> shown below,</p>
<pre class="sourceCode r"><code class="sourceCode r">(x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<p>and we wanted to apply the logarithm operation on each element of <code>x</code>,
it wouldn’t be convenient to type</p>
<pre><code>log(1)
log(2)
log(3)
...
log(10)</code></pre>
<p>The concept of iteration allows us to programme the following command:</p>
<blockquote>
<p>Repeat <code>log</code> for each value of my input <code>x</code>.</p>
</blockquote>
<p>or more formally</p>
<blockquote>
<p>Repeat <code>log(i)</code> where <code>i</code> takes in turn each value of my input <code>x</code>.</p>
</blockquote>
<p>We will see different ways of implementing such an iteration.</p>
<div id="using-a-for-loop" class="section level3 unnumbered">
<h3>Using a <code>for</code> loop</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> x)
    <span class="kw">print</span>(<span class="kw">log</span>(i))</code></pre>
<pre><code>## [1] 0
## [1] 0.6931472
## [1] 1.098612
## [1] 1.386294
## [1] 1.609438
## [1] 1.791759
## [1] 1.94591
## [1] 2.079442
## [1] 2.197225
## [1] 2.302585</code></pre>
<p>The loop above only prints the results on screen. They aren’t stored
and are lost for any further re-use, which would be very annoying if
if took much more time to perform all the calculations. In the code
chunk below, we are going to first inititalise a vector with the
appropriate number of <code>NA</code> values and, at each iteration, we then
store the result. We however now need to change our loop and iterate
of the indices of the input vector, so that we can re-use these
indices to save the results in the output vector.</p>
<pre class="sourceCode r"><code class="sourceCode r">res_loop &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(x))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x))
    res_loop[i] &lt;-<span class="st"> </span><span class="kw">log</span>(x[i])
res_loop</code></pre>
<pre><code>##  [1] 0.0000000 0.6931472 1.0986123 1.3862944 1.6094379 1.7917595 1.9459101
##  [8] 2.0794415 2.1972246 2.3025851</code></pre>
</div>
<div id="using-the-apply-function" class="section level3 unnumbered">
<h3>Using the <code>apply</code> function</h3>
<p>The apply family of functions implements our defintion of iteration
quite literally</p>
<blockquote>
<p>Repeat <code>log</code> for each value of my input <code>x</code></p>
</blockquote>
<p>is reformulated as</p>
<blockquote>
<p>For each value of my input <code>x</code>, apply <code>log</code></p>
</blockquote>
<p>and coded as</p>
<pre class="sourceCode r"><code class="sourceCode r">res_apply &lt;-<span class="st"> </span><span class="kw">sapply</span>(x, log)
res_apply</code></pre>
<pre><code>##  [1] 0.0000000 0.6931472 1.0986123 1.3862944 1.6094379 1.7917595 1.9459101
##  [8] 2.0794415 2.1972246 2.3025851</code></pre>
<p>There are three such function that <em>apply</em> a function iteratively:</p>
<ul>
<li><p><code>sapply</code> iterates over a vector and returns a new vector of the same
length as the input vector<label for="tufte-sn-18" class="margin-toggle sidenote-number">18</label><input type="checkbox" id="tufte-sn-18" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">18</span> This is a simplification of how <code>sapply</code> works,
that is partly defined by the the <code>simplify</code> argument and whether
the result of applying the function on each element of the input
can be returned as a vector. The alternative is to return a
<code>list</code>, like <code>lapply</code>.</span>.</p></li>
<li><p><code>lapply</code> iterates over a linear input (a vector of a list) and
returns a list of the same length as the input.</p></li>
<li><p><code>apply</code> iterates of the rows or the columns of a <code>data.frame</code> or
<code>matrix</code> and returns a list or vector or approritate length (number
of rows or columns). The dimension over which the iterations
proceeds is defined by the second argument, where <code>1</code> defines rows
and <code>2</code> defined columns<label for="tufte-sn-19" class="margin-toggle sidenote-number">19</label><input type="checkbox" id="tufte-sn-19" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">19</span> This generalises to arrays with more than 2 dimensions.</span>.</p></li>
</ul>
<p>When performing the same operations in different ways (using different
implementations), it is essential to verify that the results are
identical or, if not, at least compatible. The most direct way to do
the former is to use the <code>identical</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(res_loop, res_apply)</code></pre>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="vectorisation" class="section level3 unnumbered">
<h3>Vectorisation</h3>
<p>We must not forget the obvious, which is vectorisation. Many R
functions work by default iteratively on every element of a vectors,
i.e. they work irrespectively whether the vector is of length
1<label for="tufte-sn-20" class="margin-toggle sidenote-number">20</label><input type="checkbox" id="tufte-sn-20" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">20</span> A vector of length 1 would be called a scalar in other
programming languages.</span> or longer.</p>
<pre class="sourceCode r"><code class="sourceCode r">res_vec &lt;-<span class="st"> </span><span class="kw">log</span>(x)
res_vec</code></pre>
<pre><code>##  [1] 0.0000000 0.6931472 1.0986123 1.3862944 1.6094379 1.7917595 1.9459101
##  [8] 2.0794415 2.1972246 2.3025851</code></pre>
<p>And, as before, we check that we obtain identical results:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(res_loop, res_vec)</code></pre>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="which-iteration-to-use" class="section level3">
<h3><span class="header-section-number">9.3.1</span> Which iteration to use?</h3>
<p>Even though they produce the same result, the iteration strategies
above aren’t equal, and some should be preferred in different
situtions.</p>
<ul>
<li><p>When a vectorised solution exists, this is the one that should be
chosen. It is by far the fastest solution, but only applicable to
existing functions. If you were to write your own function to
iterate over, it is advisable to write a vectorised function.</p></li>
<li><p>The apply functions are extremely convenient and concise, and hence
widely used. They have a couple of advantages, including that there
is no need to explicitly initialise a result variable and that they
can easily be parallelised.</p></li>
<li><p>For loops are the most generic solution for iteration, and they
require to initialise the result variable that will be populated
during the loop. As opposed to popular belief, they aren’t slower
than using apply functions. They are however the best solution if,
during the iteration, one has the access another element than the
one currently processed (typically, if <code>i</code> is the coutner, accessing
<code>i + 1</code> or <code>i - 1</code>).</p></li>
</ul>
<!-- Possibly also mention `while`. -->
</div>
</div>
<div id="conditionals" class="section level2">
<h2><span class="header-section-number">9.4</span> Conditionals</h2>
<p><code>if</code> and <code>else</code>.</p>
</div>
<div id="example-iterating-over-files" class="section level2">
<h2><span class="header-section-number">9.5</span> Example: iterating over files</h2>

</div>
</div>
<p style="text-align: center;">
<a href="sec-bioinfo.html"><button class="btn btn-default">Previous</button></a>
<a href="sec-ccl.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2019-02-22
</p>
</div>
</div>



</body>
</html>
